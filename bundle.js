!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";function i(t,e=null,s=null){const i=document.createElement(t);return e&&function(t,e){Object.keys(e).forEach(s=>{switch(s){case"classes":e[s].forEach(e=>t.classList.add(e));break;case"textContent":t.textContent=e[s];break;case"selected":t.selected=e[s];default:t.setAttribute(s,e[s])}})}(i,e),s&&function(t,e){e.forEach(e=>t.appendChild(e))}(i,s),i}s.r(e);class n{constructor({parent:t,max:e,min:s,step:i=1,value:n,prop:r,scope:a,updateFn:h,label:l}){this.prop=r,this.scope=a,this.updateFn=h,this.label=l,this.max=e,this.min=s,this.step=i,this.value=n,this.parent=t,this.node=null,this.input=null,this.output=null,this.render(),this.eventListener()}render(){this.input=i("input",{type:"range",id:this.prop,max:this.max,min:this.min,step:this.step,value:this.value}),this.output=i("output",{textContent:this.value}),this.node=i("div",{classes:["slider"]},[i("label",{for:this.prop,textContent:`${this.label} â€” `}),this.output,i("br"),this.input]),this.parent.appendChild(this.node)}disable(){this.input.disabled=!0,this.node.style.opacity=.3}enable(){this.input.disabled=!1,this.node.style.opacity=1}eventListener(){this.input.addEventListener("input",this.eventHandler.bind(this))}eventHandler(t){const e=this.input.valueAsNumber;this.output.textContent=e,this.scope[this.prop]=e,this.updateFn()}}class r{constructor({parent:t,prop:e,scope:s=null,updateFn:i,value:n,labelTrue:r="on",labelFalse:a="off"}){this.prop=e,this.scope=s,this.updateFn=i,this.labelTrue=r,this.labelFalse=a,this.value=n,this.node=null,this.parent=t,this.render(),this.eventListener()}render(){this.node=i("button",{id:this.prop,classes:["toggle"]},null),this.value?this.node.innerHTML=this.labelTrue:(this.node.classList.add("deactivated"),this.node.innerHTML=this.labelFalse),this.parent.appendChild(this.node)}eventListener(){this.node.addEventListener("click",this.eventHandler.bind(this))}eventHandler(t){this.node.classList.toggle("deactivated"),this.value=!this.value,this.value?this.node.innerHTML=this.labelTrue:this.node.innerHTML=this.labelFalse,this.scope&&(this.scope[this.prop]=this.value),this.updateFn()}}class a{constructor({parent:t,fn:e,updateFn:s=null,label:i}){this.fn=e,this.updateFn=s,this.label=i,this.node=null,this.parent=t,this.render(),this.eventListener()}render(){this.node=i("button",{id:this.label.replace(/\s/g,"-")},null),this.node.innerHTML=this.label,this.parent.appendChild(this.node)}eventListener(){this.node.addEventListener("click",this.eventHandler.bind(this))}eventHandler(t){this.fn(),this.updateFn&&this.updateFn()}}const h={saveImg:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="save" class="svg-inline--fa fa-save fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"></path></svg>',erase:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="eraser" class="svg-inline--fa fa-eraser fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"></path></svg>',randomOptions:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="dice-five" class="svg-inline--fa fa-dice-five fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M384 32H64C28.65 32 0 60.65 0 96v320c0 35.35 28.65 64 64 64h320c35.35 0 64-28.65 64-64V96c0-35.35-28.65-64-64-64zM128 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm0-192c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm96 96c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm96 96c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm0-192c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"></path></svg>',play:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="play" class="svg-inline--fa fa-play fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path></svg>',pause:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="pause" class="svg-inline--fa fa-pause fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"></path></svg>',cross:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>',circle:'<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="circle" class="svg-inline--fa fa-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200z"></path></svg>',circleSolid:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="circle" class="svg-inline--fa fa-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"></path></svg>'};function l(t){const e=document.querySelector("#ui"),s=document.createElement("div"),i=document.createElement("p");return i.textContent=t,s.appendChild(i),e.appendChild(s),s}function o(t,e=t.min,s=t.max){t.input.value=function(t,e,s=!0){return s?Math.floor(Math.random()*(e-t+1)+t):Math.random()*(e-t)+t}(e,s,!1),t.eventHandler()}class c{constructor(t=0,e=0){this.x=t,this.y=e}static fromPolar(t,e,s=e){const i=e*Math.cos(t),n=s*Math.sin(t);return new this(Math.floor(i),Math.floor(n))}static add(t,e){return new this(t.x+e.x,t.y+e.y)}static sub(t,e){return new this(t.x-e.x,t.y-e.y)}static eq(t,e){return t.x===e.x&&t.y===e.y}add(t){return this.x+=t.x,this.y+=t.y,this}addX(t){return this.x+=t,this}addY(t){return this.y+=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subX(t){return this.x-=t,this}subY(t){return this.y-=t,this}mul(t){return this.x=this.x*t,this.y=this.y*t,this}div(t){if(0!==t)return this.x=this.x/t,this.y=this.y/t,this}get magnitude(){return Math.hypot(this.x,this.y)}normalize(){return this.div(this.magnitude),this}getDistance(t={x:0,y:0}){const e=t.x-this.x,s=t.y-this.y;return Math.hypot(e,s)}getAngle(t={x:0,y:0}){return Math.atan2(this.y-t.y,this.x-t.x)}getMiddle(t){const e=.5*(this.x+t.x),s=.5*(this.y+t.y);return new c(e,s)}eq(t){return this.x===t.x&&this.y===t.y}isOpposite(t){return!this.eq(t)&&(this.x===-t.x&&this.y===-t.y)}copy(){return new c(this.x,this.y)}set(t){return this.x=t.x,this.y=t.y,this}change(t,e){return this.x=t,this.y=e,this}}class p{constructor({type:t="sin",amp:e,freq:s=1,phase:i=0,vShift:n=0,angleVel:r,angle:a=0}){this.type=t,this.amp=e,this.freq=s,this.phase=i,this.vShift=n,this.angle=a,this.angleVel=r,this.orig={amp:e,freq:s,phase:i,vShift:n,angle:a,angleVel:r}}oscillate(t=this.angleVel){return this.angle+=t,this.amp*Math.cos(this.freq*this.angle+this.phase)+this.vShift}reset(){return Object.entries(this.orig).forEach((t,e)=>this[t]=e),this}copy(){return new this({amp:this.amp,freq:this.freq,phase:this.phase,vShift:this.vShift,angle:this.angle,angleVel:this.angleVel,type:this.type})}}class u{constructor({ctx:t,radius:e,position:s,damping:i=.9,fixed:n=!1,boundaries:r={n:0,s:t.canvas.clientHeight,w:0,e:t.canvas.clientWidth}}){this.ctx=t,this.boundaries=r,this.radius=e,this.fixed=n,this.position=s,this.acceleration=new c,this.velocity=new c,this.damping=i,this.dragging=!1,this.dragOffset=new c}applyForce(t){this.acceleration.add(t)}update(){this.fixed||(this.velocity.add(this.acceleration),this.velocity.mul(this.damping),this.position.add(this.velocity),this.checkEdges(),this.acceleration.mul(0))}draw(){!function(t,e,s){t.beginPath(),t.arc(s.x,s.y,e,0,2*Math.PI,!1),t.closePath()}(this.ctx,this.radius,this.position),this.ctx.fill()}checkEdges(){(this.position.x>this.boundaries.e||this.position.x<this.boundaries.w)&&(this.position.x=this.position.x>this.boundaries.e?this.boundaries.e:this.boundaries.w,this.velocity.x*=-1),(this.position.y>this.boundaries.s||this.position.y<this.boundaries.n)&&(this.position.y=this.position.y>this.boundaries.s?this.boundaries.s:this.boundaries.n,this.velocity.y*=-1)}handleClick(t,e,s=!1){const i=new c(t,e),n=i.getDistance(this.position);(n<8&&!s||n<30)&&(this.dragging=!0,this.dragOffset.set(this.position.copy().sub(i)))}handleDrag(t,e){this.dragging&&this.position.change(t+this.dragOffset.x,e+this.dragOffset.y)}stopDragging(){this.dragging=!1}}class d{constructor({ctx:t,a:e,b:s,restLength:i=e.getDistance(s),strength:n=.2}){this.ctx=t,this.a=e,this.b=s,this.restLength=i,this.strength=n}update(){let t=c.sub(this.a.position,this.b.position),e=t.magnitude-this.restLength;t.normalize().mul(-1*this.strength*e),this.a.dragging||this.a.applyForce(t),this.b.dragging||(t.mul(-1),this.b.applyForce(t))}draw(){this.ctx.beginPath(),this.ctx.moveTo(this.a.position.x,this.a.position.y),this.ctx.lineTo(this.b.position.x,this.b.position.y),this.ctx.stroke()}}class g{constructor({ctx:t,lineWidth:e,rowNumber:s,sep:i,radius:n,origin:r,structuralSpringStrength:a,shearSpringStrength:h,bendSpringStrength:l}){this.ctx=t,this.lineWidth=e,this.radius=n,this.origin=r,this.sep=i,this.rowNumber=s,this.width=s*i,this.structuralSpringStrength=a,this.shearSpringStrength=h,this.bendSpringStrength=l,this.setup()}col(t){return t%this.rowNumber}row(t){return Math.floor(t/this.rowNumber)}lockParticles(...t){t.length>0&&t.forEach(t=>this.particles[t].fixed=!0)}setup(){this.setParticles(),this.setStructuralSprings(),this.setShearSprings(),this.setBendSprings(),this.ctx.lineWidth=this.lineWidth}setParticles(){this.particles=[];const t=new c(this.rowNumber/2-.5,this.rowNumber/2-.5);this.particles=Array.from({length:this.rowNumber*this.rowNumber},(e,s)=>{return new u({ctx:this.ctx,radius:this.radius,position:new c((this.col(s)-t.x)*this.sep+this.origin.x,(this.row(s)-t.y)*this.sep+this.origin.y)})})}setStructuralSprings(t=this.structuralSpringStrength,e=this.sep){this.structuralSprings=[];for(let[s,i]of this.particles.entries())this.col(s)<this.rowNumber-1&&this.structuralSprings.push(new d({ctx:this.ctx,restLength:e,strength:t,a:i,b:this.particles[s+1]})),this.row(s)<this.rowNumber-1&&this.structuralSprings.push(new d({ctx:this.ctx,restLength:e,strength:t,a:i,b:this.particles[s+this.rowNumber]}))}setShearSprings(t=this.shearSpringStrength,e=this.sep){this.shearSprings=[];for(let[s,i]of this.particles.entries())this.col(s)>0&&this.row(s)<this.rowNumber-1&&this.shearSprings.push(new d({ctx:this.ctx,restLength:e,strength:t,a:i,b:this.particles[s+this.rowNumber-1]})),this.col(s)<this.rowNumber-1&&this.row(s)<this.rowNumber-1&&this.shearSprings.push(new d({ctx:this.ctx,restLength:e,strength:t,a:i,b:this.particles[s+this.rowNumber+1]}))}setBendSprings(t=this.bendSpringStrength){this.bendSprings=[];for(let[e,s]of this.particles.entries())this.col(e)<this.rowNumber-2&&this.bendSprings.push(new d({ctx:this.ctx,restLength:2*this.sep,strength:t,a:s,b:this.particles[e+2]})),this.row(e)<this.rowNumber-2&&this.bendSprings.push(new d({ctx:this.ctx,restLength:2*this.sep,strength:t,a:s,b:this.particles[e+2*this.rowNumber]}))}update(){this.structuralSprings.forEach(t=>t.update()),this.shearSprings.forEach(t=>t.update()),this.bendSprings.forEach(t=>t.update()),this.particles.forEach(t=>t.update())}drawStructuralSprings(){this.structuralSprings.forEach(t=>t.draw())}drawShearSprings(){this.shearSprings.forEach(t=>t.draw())}drawBendSprings(){this.bendSprings.forEach(t=>t.draw())}drawSprings(){this.drawStructuralSprings(),this.drawShearSprings(),this.drawBendSprings()}drawParticles(){this.particles.forEach(t=>t.draw())}setDragging(){this.ctx.canvas.addEventListener("touchstart",t=>{t.preventDefault();const e=t.touches[0];this.particles.forEach(t=>t.handleClick(e.pageX,e.pageY,!0))}),this.ctx.canvas.addEventListener("touchmove",t=>{t.preventDefault();const e=t.touches[0];this.particles.forEach(t=>t.handleDrag(e.pageX,e.pageY))}),this.ctx.canvas.addEventListener("touchend",t=>{t.preventDefault(),this.particles.forEach(t=>t.stopDragging())}),this.ctx.canvas.addEventListener("mousedown",t=>{1===t.buttons&&this.particles.forEach(e=>e.handleClick(t.clientX,t.clientY))}),this.ctx.canvas.addEventListener("mousemove",t=>{this.particles.forEach(e=>e.handleDrag(t.clientX,t.clientY))}),this.ctx.canvas.addEventListener("mouseup",t=>{this.particles.forEach(t=>t.stopDragging())})}}!function(){const t=document.querySelector("#panel"),e=document.querySelector("#toggle-panel");new r({parent:e,prop:"toggle-panel-btn",value:!1,labelTrue:h.circleSolid,labelFalse:h.cross,updateFn:function(){this.value?t.classList.add("hide"):t.classList.remove("hide")}})}(),function({ctx:t}){const e=t.canvas.clientHeight,s=t.canvas.clientWidth,u=new c(s/2,e/2),d=new p({amp:127.5,vShift:127.5,angleVel:.03});let f=new g({ctx:t,rowNumber:10,sep:35,radius:2,lineWidth:.3,origin:u,structuralSpringStrength:.2,shearSpringStrength:.08,bendSpringStrength:.09});f.setDragging(),t.fillStyle="rgba(255, 255, 255, .05)",t.strokeStyle="rgba(0, 0, 0, .05)";const v=e=>{t.fillStyle="#fff",t.fillRect(0,0,t.canvas.width,t.canvas.height)};v();const m=t=>{f.lineWidth>0&&f.drawStructuralSprings(),f.drawParticles()},w=e=>{const s=d.oscillate();t.fillStyle=`rgba(${s}, ${s}, ${s}, .5)`,t.strokeStyle=`rgba(${s}, ${s}, ${s}, .5)`,f.update()},b=function(t,e=0,s=(t=>void 0)){let i,n=!1;const r=function(t){let e=0,s=0;const i=t;return t=>{let n=t-e;if(e=t,(s+=n)>i)return s=0,!0}}(e),a=t=>{n||(n=!0),i=window.requestAnimationFrame(l)},h=t=>{i&&(window.cancelAnimationFrame(i),i=void 0,n=!1)},l=(e=0)=>{s()?h():(r(e)&&t(),a())};return{start:a,stop:h,toggle:t=>{(n=!n)?a():h()},get animating(){return n}}}(t=>{m(),w()},0);return document.addEventListener("keyup",t=>{" "==t.key&&b.toggle(),"e"==t.key&&v(),"r"==t.key&&(v(),f.setup())}),function({mesh:t,oscillator:e,updateFn:s,eraseFn:i,animationToggleFn:c,saveImgFn:p}){const u=document.querySelector("#buttons"),d=(new a({parent:u,fn:i,updateFn:null,label:h.erase}),new r({parent:u,prop:"toggle-animation-btn",value:!0,labelTrue:h.pause,labelFalse:h.play,updateFn:c}),new a({parent:u,fn:p,updateFn:null,label:h.saveImg}),l("Grid options")),g=new n({parent:d,max:30,min:2,value:10,label:"row #",prop:"rowNumber",scope:t,updateFn:s}),f=new n({parent:d,max:65,min:10,value:35,label:"nodes distance",prop:"sep",scope:t,updateFn:s}),v=new n({parent:d,max:10,min:0,value:2,label:"particles radius",prop:"radius",scope:t,updateFn:s}),m=new n({parent:d,max:10,min:0,value:.3,step:.01,label:"line width",prop:"lineWidth",scope:t,updateFn:s}),w=l("Spring forces"),b=new n({parent:w,max:.3,min:0,value:.2,step:.01,label:"structural",prop:"structuralSpringStrength",scope:t,updateFn:s}),x=new n({parent:w,max:.3,min:0,value:.08,step:.01,label:"shear",prop:"shearSpringStrength",scope:t,updateFn:s}),y=new n({parent:w,max:.3,min:0,value:.09,step:.01,label:"bend",prop:"bendSpringStrength",scope:t,updateFn:s}),S=l("Other options"),F=new n({parent:S,max:.1,min:0,value:.03,step:.001,label:"oscillator speed",prop:"angleVel",scope:e,updateFn:s}),L=new n({parent:S,max:255,min:0,value:127.5,step:.5,label:"color lightness",prop:"vShift",scope:e,updateFn:s});new a({parent:u,updateFn:null,label:h.randomOptions,fn:t=>{o(g),o(f),o(v),o(m),o(b),o(x),o(y),o(F),o(L,87.5,167.5)}})}({mesh:f,oscillator:d,eraseFn:t=>{v()},animationToggleFn:t=>{b.toggle()},saveImgFn:e=>{b.animating&&b.stop(),function(t){const e=i("a",{download:"img.png",href:t.toDataURL("image/png"),style:"display:none"});document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)}(t.canvas)},updateFn:t=>{v(),f.setup(),d.vShift>127.5?d.amp=127.5-d.vShift%127.5:d.amp=d.vShift}}),{clean:v,draw:m,update:w,animation:b}}({ctx:function(t="canvas"){const e=window.devicePixelRatio,s=window.innerHeight,i=window.innerWidth,n=document.querySelector(t);n.width=i*e,n.height=s*e;const r=n.getContext("2d");return r.scale(e,e),r}()}).animation.start()}]);