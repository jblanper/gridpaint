!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function s(t,e=null,i=null){const s=document.createElement(t);return e&&function(t,e){Object.keys(e).forEach(i=>{switch(i){case"classes":e[i].forEach(e=>t.classList.add(e));break;case"textContent":t.textContent=e[i];break;case"selected":t.selected=e[i];default:t.setAttribute(i,e[i])}})}(s,e),i&&function(t,e){e.forEach(e=>t.appendChild(e))}(s,i),s}i.r(e);class n{constructor({parent:t,max:e,min:i,step:s=1,value:n,prop:r,scope:h,updateFn:a,label:o}){this.prop=r,this.scope=h,this.updateFn=a,this.label=o,this.max=e,this.min=i,this.step=s,this.value=n,this.parent=t,this.node=null,this.input=null,this.output=null,this.render(),this.eventListener()}render(){this.input=s("input",{type:"range",id:this.prop,max:this.max,min:this.min,step:this.step,value:this.value}),this.output=s("output",{textContent:this.value}),this.node=s("div",{classes:["slider"]},[s("label",{for:this.prop,textContent:`${this.label} â€” `}),this.output,s("br"),this.input]),this.parent.appendChild(this.node)}disable(){this.input.disabled=!0,this.node.style.opacity=.3}enable(){this.input.disabled=!1,this.node.style.opacity=1}eventListener(){this.input.addEventListener("input",this.eventHandler.bind(this))}eventHandler(t){const e=this.input.valueAsNumber;this.output.textContent=e,this.scope[this.prop]=e,this.updateFn()}}class r{constructor({parent:t,prop:e,scope:i=null,updateFn:s,value:n,labelTrue:r="on",labelFalse:h="off"}){this.prop=e,this.scope=i,this.updateFn=s,this.labelTrue=r,this.labelFalse=h,this.value=n,this.node=null,this.parent=t,this.render(),this.eventListener()}render(){this.node=s("button",{id:this.prop,classes:["toggle"]},null),this.value?this.node.textContent=this.labelTrue:(this.node.classList.add("deactivated"),this.node.textContent=this.labelFalse),this.parent.appendChild(this.node)}eventListener(){this.node.addEventListener("click",this.eventHandler.bind(this))}eventHandler(t){this.node.classList.toggle("deactivated"),this.value=!this.value,this.value?this.node.textContent=this.labelTrue:this.node.textContent=this.labelFalse,this.scope&&(this.scope[this.prop]=this.value),this.updateFn()}}function h(t){const e=document.querySelector("#ui"),i=document.createElement("div"),s=document.createElement("p");return s.textContent=t,i.appendChild(s),e.appendChild(i),i}class a{constructor(t=0,e=0){this.x=t,this.y=e}static fromPolar(t,e,i=e){const s=e*Math.cos(t),n=i*Math.sin(t);return new this(Math.floor(s),Math.floor(n))}static add(t,e){return new this(t.x+e.x,t.y+e.y)}static sub(t,e){return new this(t.x-e.x,t.y-e.y)}static eq(t,e){return t.x===e.x&&t.y===e.y}add(t){return this.x+=t.x,this.y+=t.y,this}addX(t){return this.x+=t,this}addY(t){return this.y+=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subX(t){return this.x-=t,this}subY(t){return this.y-=t,this}mul(t){return this.x=this.x*t,this.y=this.y*t,this}div(t){if(0!==t)return this.x=this.x/t,this.y=this.y/t,this}get magnitude(){return Math.hypot(this.x,this.y)}normalize(){return this.div(this.magnitude),this}getDistance(t={x:0,y:0}){const e=t.x-this.x,i=t.y-this.y;return Math.hypot(e,i)}getAngle(t={x:0,y:0}){return Math.atan2(this.y-t.y,this.x-t.x)}getMiddle(t){const e=.5*(this.x+t.x),i=.5*(this.y+t.y);return new a(e,i)}eq(t){return this.x===t.x&&this.y===t.y}isOpposite(t){return!this.eq(t)&&(this.x===-t.x&&this.y===-t.y)}copy(){return new a(this.x,this.y)}set(t){return this.x=t.x,this.y=t.y,this}change(t,e){return this.x=t,this.y=e,this}}class o{constructor({type:t="sin",amp:e,freq:i=1,phase:s=0,vShift:n=0,angleVel:r,angle:h=0}){this.type=t,this.amp=e,this.freq=i,this.phase=s,this.vShift=n,this.angle=h,this.angleVel=r,this.orig={amp:e,freq:i,phase:s,vShift:n,angle:h,angleVel:r}}oscillate(t=this.angleVel){return this.angle+=t,this.amp*Math.cos(this.freq*this.angle+this.phase)+this.vShift}reset(){return Object.entries(this.orig).forEach((t,e)=>this[t]=e),this}copy(){return new this({amp:this.amp,freq:this.freq,phase:this.phase,vShift:this.vShift,angle:this.angle,angleVel:this.angleVel,type:this.type})}}class l{constructor({ctx:t,radius:e,position:i,damping:s=.9,fixed:n=!1,boundaries:r={n:0,s:t.canvas.clientHeight,w:0,e:t.canvas.clientWidth}}){this.ctx=t,this.boundaries=r,this.radius=e,this.fixed=n,this.position=i,this.acceleration=new a,this.velocity=new a,this.damping=s,this.dragging=!1,this.dragOffset=new a}applyForce(t){this.acceleration.add(t)}update(){this.fixed||(this.velocity.add(this.acceleration),this.velocity.mul(this.damping),this.position.add(this.velocity),this.checkEdges(),this.acceleration.mul(0))}draw(){!function(t,e,i){t.beginPath(),t.arc(i.x,i.y,e,0,2*Math.PI,!1),t.closePath()}(this.ctx,this.radius,this.position),this.ctx.fill()}checkEdges(){(this.position.x>this.boundaries.e||this.position.x<this.boundaries.w)&&(this.position.x=this.position.x>this.boundaries.e?this.boundaries.e:this.boundaries.w,this.velocity.x*=-1),(this.position.y>this.boundaries.s||this.position.y<this.boundaries.n)&&(this.position.y=this.position.y>this.boundaries.s?this.boundaries.s:this.boundaries.n,this.velocity.y*=-1)}handleClick(t,e){const i=new a(t,e);i.getDistance(this.position)<6&&(this.dragging=!0,this.dragOffset.set(this.position.copy().sub(i)))}handleDrag(t,e){this.dragging&&this.position.change(t+this.dragOffset.x,e+this.dragOffset.y)}stopDragging(){this.dragging=!1}}class p{constructor({ctx:t,a:e,b:i,restLength:s=e.getDistance(i),strength:n=.2}){this.ctx=t,this.a=e,this.b=i,this.restLength=s,this.strength=n}update(){let t=a.sub(this.a.position,this.b.position),e=t.magnitude-this.restLength;t.normalize().mul(-1*this.strength*e),this.a.dragging||this.a.applyForce(t),this.b.dragging||(t.mul(-1),this.b.applyForce(t))}draw(){this.ctx.beginPath(),this.ctx.moveTo(this.a.position.x,this.a.position.y),this.ctx.lineTo(this.b.position.x,this.b.position.y),this.ctx.stroke()}}class u{constructor({ctx:t,lineWidth:e,rowNumber:i,sep:s,radius:n,origin:r,structuralSpringStrength:h,shearSpringStrength:a,bendSpringStrength:o}){this.ctx=t,this.lineWidth=e,this.radius=n,this.origin=r,this.sep=s,this.rowNumber=i,this.width=i*s,this.structuralSpringStrength=h,this.shearSpringStrength=a,this.bendSpringStrength=o,this.setup()}col(t){return t%this.rowNumber}row(t){return Math.floor(t/this.rowNumber)}lockParticles(...t){t.length>0&&t.forEach(t=>this.particles[t].fixed=!0)}setup(){this.setParticles(),this.setStructuralSprings(),this.setShearSprings(),this.setBendSprings(),this.ctx.lineWidth=this.lineWidth}setParticles(){this.particles=[];const t=new a(this.rowNumber/2-.5,this.rowNumber/2-.5);this.particles=Array.from({length:this.rowNumber*this.rowNumber},(e,i)=>{return new l({ctx:this.ctx,radius:this.radius,position:new a((this.col(i)-t.x)*this.sep+this.origin.x,(this.row(i)-t.y)*this.sep+this.origin.y)})})}setStructuralSprings(t=this.structuralSpringStrength,e=this.sep){this.structuralSprings=[];for(let[i,s]of this.particles.entries())this.col(i)<this.rowNumber-1&&this.structuralSprings.push(new p({ctx:this.ctx,restLength:e,strength:t,a:s,b:this.particles[i+1]})),this.row(i)<this.rowNumber-1&&this.structuralSprings.push(new p({ctx:this.ctx,restLength:e,strength:t,a:s,b:this.particles[i+this.rowNumber]}))}setShearSprings(t=this.shearSpringStrength,e=this.sep){this.shearSprings=[];for(let[i,s]of this.particles.entries())this.col(i)>0&&this.row(i)<this.rowNumber-1&&this.shearSprings.push(new p({ctx:this.ctx,restLength:e,strength:t,a:s,b:this.particles[i+this.rowNumber-1]})),this.col(i)<this.rowNumber-1&&this.row(i)<this.rowNumber-1&&this.shearSprings.push(new p({ctx:this.ctx,restLength:e,strength:t,a:s,b:this.particles[i+this.rowNumber+1]}))}setBendSprings(t=this.bendSpringStrength){this.bendSprings=[];for(let[e,i]of this.particles.entries())this.col(e)<this.rowNumber-2&&this.bendSprings.push(new p({ctx:this.ctx,restLength:2*this.sep,strength:t,a:i,b:this.particles[e+2]})),this.row(e)<this.rowNumber-2&&this.bendSprings.push(new p({ctx:this.ctx,restLength:2*this.sep,strength:t,a:i,b:this.particles[e+2*this.rowNumber]}))}update(){this.structuralSprings.forEach(t=>t.update()),this.shearSprings.forEach(t=>t.update()),this.bendSprings.forEach(t=>t.update()),this.particles.forEach(t=>t.update())}drawStructuralSprings(){this.structuralSprings.forEach(t=>t.draw())}drawShearSprings(){this.shearSprings.forEach(t=>t.draw())}drawBendSprings(){this.bendSprings.forEach(t=>t.draw())}drawSprings(){this.drawStructuralSprings(),this.drawShearSprings(),this.drawBendSprings()}drawParticles(){this.particles.forEach(t=>t.draw())}setDragging(){document.addEventListener("mousedown",t=>{1===t.buttons&&this.particles.forEach(e=>e.handleClick(t.clientX,t.clientY))}),document.addEventListener("mousemove",t=>{this.particles.forEach(e=>e.handleDrag(t.clientX,t.clientY))}),document.addEventListener("mouseup",t=>{this.particles.forEach(t=>t.stopDragging())})}}!function(){const t=document.querySelector("#panel"),e=document.querySelector("#toggle-panel");new r({parent:e,prop:"toggle-panel-btn",value:!1,labelTrue:"O",labelFalse:"X",updateFn:function(){this.value?t.classList.add("hide"):t.classList.remove("hide")}})}(),function({ctx:t}){const e=t.canvas.clientHeight,i=t.canvas.clientWidth,s=new a(i/2,e/2),r=new o({amp:127.5,vShift:127.5,angleVel:.03});let l=new u({ctx:t,rowNumber:10,sep:35,radius:2,lineWidth:.3,origin:s,structuralSpringStrength:.2,shearSpringStrength:.08,bendSpringStrength:.09});l.setDragging(),t.fillStyle="rgba(255, 255, 255, .05)",t.strokeStyle="rgba(0, 0, 0, .05)";const p=e=>{t.fillStyle="#fff",t.fillRect(0,0,t.canvas.width,t.canvas.height)};p();const c=t=>{l.lineWidth>0&&l.drawStructuralSprings(),l.drawParticles()},d=e=>{const i=r.oscillate();t.fillStyle=`rgba(${i}, ${i}, ${i}, .5)`,t.strokeStyle=`rgba(${i}, ${i}, ${i}, .5)`,l.update()},g=function(t,e=0,i=(t=>void 0)){let s,n=!1;const r=function(t){let e=0,i=0;const s=t;return t=>{let n=t-e;if(e=t,(i+=n)>s)return i=0,!0}}(e),h=t=>{n||(n=!0),s=window.requestAnimationFrame(o)},a=t=>{s&&(window.cancelAnimationFrame(s),s=void 0,n=!1)},o=(e=0)=>{i()?a():(r(e)&&t(),h())};return{start:h,stop:a,toggle:t=>{(n=!n)?h():a()},get animating(){return n}}}(t=>{c(),d()},0);return document.addEventListener("keyup",t=>{" "==t.key&&g.toggle(),"e"==t.key&&p(),"r"==t.key&&(p(),l.setup())}),function({mesh:t,oscillator:e,updateFn:i}){const s=h("Grid options"),r=(new n({parent:s,max:40,min:2,value:10,label:"row #",prop:"rowNumber",scope:t,updateFn:i}),new n({parent:s,max:45,min:10,value:35,label:"nodes distance",prop:"sep",scope:t,updateFn:i}),new n({parent:s,max:10,min:0,value:2,label:"particles radius",prop:"radius",scope:t,updateFn:i}),new n({parent:s,max:10,min:0,value:.3,step:.01,label:"line width",prop:"lineWidth",scope:t,updateFn:i}),h("Spring forces")),a=(new n({parent:r,max:.3,min:0,value:.2,step:.01,label:"structural",prop:"structuralSpringStrength",scope:t,updateFn:i}),new n({parent:r,max:.3,min:0,value:.08,step:.01,label:"shear",prop:"shearSpringStrength",scope:t,updateFn:i}),new n({parent:r,max:.3,min:0,value:.09,step:.01,label:"bend",prop:"bendSpringStrength",scope:t,updateFn:i}),h("Other options"));new n({parent:a,max:.1,min:0,value:.03,step:.001,label:"oscillator speed",prop:"angleVel",scope:e,updateFn:i}),new n({parent:a,max:255,min:0,value:127.5,step:.5,label:"color lightness",prop:"vShift",scope:e,updateFn:i})}({mesh:l,oscillator:r,updateFn:t=>{p(),l.setup(),r.vShift>127.5?r.amp=127.5-r.vShift%127.5:r.amp=r.vShift}}),{clean:p,draw:c,update:d,animation:g}}({ctx:function(t="canvas"){const e=window.devicePixelRatio,i=window.innerHeight,s=window.innerWidth,n=document.querySelector(t);n.width=s*e,n.height=i*e;const r=n.getContext("2d");return r.scale(e,e),r}()}).animation.start()}]);